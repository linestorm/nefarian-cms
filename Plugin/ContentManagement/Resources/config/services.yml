parameters:
  nefarian.plugins.content_management.doctrine.node_listener.class:  Nefarian\CmsBundle\Plugin\ContentManagement\Doctrine\EventListener\NodeEventListener
  nefarian.plugins.content_management.doctrine.content_type_listener.class:  Nefarian\CmsBundle\Plugin\ContentManagement\Doctrine\EventListener\ContentTypeEventListener

  nefarian.plugins.content_management.form.type.field_collection.class: Nefarian\CmsBundle\Plugin\ContentManagement\Form\Type\FieldCollectionType
  nefarian.plugins.content_management.form.type.field_content_collection.class: Nefarian\CmsBundle\Plugin\ContentManagement\Form\Type\FieldContentCollectionType


services:

  nefarian.plugin.content_management:
    class: Nefarian\CmsBundle\Plugin\ContentManagement\ContentManagementPlugin
    tags:
      - { name: nefarian.plugin }

  #
  # Doctrine - Map node listener
  nefarian.plugins.content_management.doctrine.node_listener:
    class: %nefarian.plugins.content_management.doctrine.node_listener.class%
    arguments:
      - @service_container
    tags:
      - { name: doctrine.event_subscriber }
#  nefarian.plugins.content_management.doctrine.content_type_listener:
#    class: %nefarian.plugins.content_management.doctrine.content_type_listener.class%
#    arguments:
#      - @service_container
#    tags:
#      - { name: doctrine.event_subscriber }

  #
  # Forms - field collection
  nefarian.plugins.content_management.form.type.field_collection:
    class: %nefarian.plugins.content_management.form.type.field_collection.class%
    arguments:
        - @nefarian_core.content_field_manager
        - @nefarian_core.config_manager
    tags:
        - { name: form.type, alias: field_collection }

  nefarian.plugins.content_management.form.type.field_content_collection:
    class: %nefarian.plugins.content_management.form.type.field_content_collection.class%
    tags:
        - { name: form.type, alias: field_content_collection }


  #
  # Configuration events
  nefarian.plugins.content_management.event_listener.configuration:
    class: Nefarian\CmsBundle\Plugin\ContentManagement\EventListener\ConfigurationEventSubscriber
    arguments:
      - @nefarian_core.config_manager
      - @doctrine.orm.default_entity_manager
    tags:
        - { name: kernel.event_subscriber }

  #
  # Node routing manager
  nefarian.plugins.content_management.node_route_manager:
    class: Nefarian\CmsBundle\Plugin\ContentManagement\Router\NodeRouterManager
    arguments:
      - @nefarian_core.config_manager

  nefarian.plugins.content_management.routing.node_path_processor:
    class: Nefarian\CmsBundle\Plugin\ContentManagement\Router\PathProcessor\NodePathProcessor
    tags:
      - {name: nefarian.node.path_processor}

  #
  # Views
  nefarian.plugin.content_management.view.mode:
    class: Nefarian\CmsBundle\Plugin\ContentManagement\View\NodeView
    tags:
      - { name: nefarian.view }

  #
  # Configurations
  nefarian.plugin.content_management.routing.configuration:
    class: Nefarian\CmsBundle\Plugin\ContentManagement\Configuration\RoutingConfiguration
    tags:
      - { name: nefarian.configuration, config: content_type.routing }
